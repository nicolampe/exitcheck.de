import{o as y,r as o,j as e,p as g,q as P,P as B,C as w,g as b,h as k,i as I,k as D,s as c,B as f,t as z,m as O,f as U}from"./index-7fG9pj76.js";import{S as p}from"./skeleton-CZHPbiG1.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=y("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=y("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=y("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),$=P("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),S=o.forwardRef(({className:s,variant:a,...t},r)=>e.jsx("div",{ref:r,role:"alert",className:g($({variant:a}),s),...t}));S.displayName="Alert";const T=o.forwardRef(({className:s,...a},t)=>e.jsx("h5",{ref:t,className:g("mb-1 font-medium leading-none tracking-tight",s),...a}));T.displayName="AlertTitle";const A=o.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:g("text-sm [&_p]:leading-relaxed",s),...a}));A.displayName="AlertDescription";var G="Separator",E="horizontal",H=["horizontal","vertical"],F=o.forwardRef((s,a)=>{const{decorative:t,orientation:r=E,...l}=s,i=L(r)?r:E,x=t?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx(B.div,{"data-orientation":i,...x,...l,ref:a})});F.displayName=G;function L(s){return H.includes(s)}var M=F;const m=o.forwardRef(({className:s,orientation:a="horizontal",decorative:t=!0,...r},l)=>e.jsx(M,{ref:l,decorative:t,orientation:a,className:g("shrink-0 bg-border",a==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));m.displayName=M.displayName;function K({result:s}){console.log("Result in ExpertoResultsDisplay:",s);let a={calculationDetails:{}},t={},r=0,l=0,i=0,d=s.companyValue||0;try{s.additionalData&&(a=JSON.parse(s.additionalData),t=a.calculationDetails||{},r=t.industryMultiplier||0,l=t.debt||0,i=t.nonOperationalAssets||0,d=t.finalPurchasePrice!==void 0?t.finalPurchasePrice:(s.companyValue||0)-l+i)}catch(n){console.error("Error parsing additionalData JSON:",n)}const x={SaaS:"Software as a Service (SaaS)",Handel:"Handel",Produktion:"Produktion",Dienstleistung:"Dienstleistung",Handwerk:"Handwerk",Gesundheitswesen:"Gesundheitswesen",IT:"IT & Technologie",Gastronomie:"Gastronomie & Hotellerie",Immobilien:"Immobilien"},N=n=>n>0?`+${(n*100).toFixed(0)}%`:n<0?`${(n*100).toFixed(0)}%`:"0%",h=()=>{alert("PDF-Download-Funktion wird implementiert")},u=()=>{navigator.share?navigator.share({title:"Mein Unternehmenswert-Ergebnis",text:`Mein geschätzter Unternehmenswert beträgt ${c(s.companyValue)}. Tatsächlicher Kaufpreis nach Anpassungen: ${c(d)}.`,url:window.location.href}).catch(n=>{console.error("Fehler beim Teilen:",n)}):navigator.clipboard.writeText(window.location.href).then(()=>alert("Link in die Zwischenablage kopiert")).catch(n=>console.error("Fehler beim Kopieren:",n))};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs(w,{className:"w-full",children:[e.jsxs(b,{className:"text-center",children:[e.jsx(k,{className:"text-2xl lg:text-3xl",children:"Ihr detaillierter Unternehmenswert"}),e.jsx(I,{children:"Berechnet nach der Everto-Multiplikator-Methode"})]}),e.jsxs(D,{className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"Unternehmenswert"}),e.jsx("p",{className:"text-3xl font-bold text-primary",children:c(s.companyValue)})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"Tatsächlicher Kaufpreis"}),e.jsx("p",{className:"text-3xl font-bold text-primary",children:c(d)}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Nach Schuldenabzug und Berücksichtigung nicht betriebsnotwendiger Vermögenswerte"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Berechnungsdetails"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Branche"}),e.jsx("span",{className:"font-medium",children:x[s.industry]||s.industry})]}),e.jsx(m,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Normalisiertes EBIT (Gewinn + GF-Gehalt)"}),e.jsx("span",{className:"font-medium",children:c(s.normalizedEBIT)})]}),e.jsx(m,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Branchenüblicher Multiplikator"}),e.jsxs("span",{className:"font-medium",children:[r.toFixed(1),"x"]})]}),e.jsx(m,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Angepasster Multiplikator"}),e.jsxs("span",{className:"font-medium",children:[(s.multiplier||0).toFixed(2),"x",e.jsx("span",{className:"text-sm text-gray-500 ml-2",children:s.qualityAdjustment>0?`(+${(s.qualityAdjustment*100).toFixed(0)}%)`:`(${(s.qualityAdjustment*100).toFixed(0)}%)`})]})]}),e.jsx(m,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Unternehmenswert (Basisberechnung)"}),e.jsx("span",{className:"font-medium",children:c(s.companyValue)})]}),e.jsx(m,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Unternehmensschulden"}),e.jsxs("span",{className:"font-medium text-red-600",children:["- ",c(l)]})]}),e.jsx(m,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Nicht betriebsnotwendiges Vermögen"}),e.jsxs("span",{className:"font-medium text-green-600",children:["+ ",c(i)]})]}),e.jsx(m,{}),e.jsxs("div",{className:"flex justify-between items-center font-bold text-lg",children:[e.jsx("span",{children:"Tatsächlicher Unternehmens-Kaufpreis"}),e.jsx("span",{children:c(d)})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Qualitätsfaktoren im Detail"}),e.jsx("div",{className:"space-y-3",children:s.qualityFactors&&Object.entries(s.qualityFactors).map(([n,j])=>{const R={customerDiversification:"Kundenstruktur & -diversifikation",recurringRevenue:"Anteil wiederkehrender Umsätze",managementTeam:"Führungsteam und organisatorische Struktur",growthRate:"Wachstumsrate der letzten Jahre",profitMargin:"Gewinnmarge",marketPosition:"Marktposition und Wettbewerbsvorteil"}[n]||n,v=j>0?"positive":j<0?"negative":"neutral";return e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-md",children:[e.jsx("span",{children:R}),e.jsx("span",{className:`font-medium ${v==="positive"?"text-green-600":v==="negative"?"text-red-600":""}`,children:N(j)})]},n)})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center mt-6",children:[e.jsxs(f,{onClick:h,className:"gap-2",children:[e.jsx(C,{size:18}),e.jsx("span",{children:"PDF-Bericht"})]}),e.jsxs(f,{variant:"outline",onClick:u,className:"gap-2",children:[e.jsx(V,{size:18}),e.jsx("span",{children:"Ergebnis teilen"})]})]})]})]}),e.jsxs(w,{children:[e.jsx(b,{children:e.jsx(k,{children:"Wie geht es weiter?"})}),e.jsxs(D,{className:"space-y-4",children:[e.jsx("p",{children:"Die Ergebnisse basieren auf dem Multiplikator-Verfahren und bieten eine erste Einschätzung. Für eine vollständige Bewertung Ihres Unternehmens empfehlen wir ein persönliches Gespräch."}),e.jsx(f,{asChild:!0,className:"w-full md:w-auto mt-2",children:e.jsxs(z,{href:"/",children:[e.jsx("span",{children:"Beratungsgespräch vereinbaren"}),e.jsx(O,{className:"ml-2 h-4 w-4"})]})})]})]})]})}function _({resultId:s}){const[a,t]=o.useState(null),[r,l]=o.useState(!0),[i,d]=o.useState(null),{toast:x}=U();return o.useEffect(()=>{(async()=>{try{console.log("Fetching result with ID:",s);const h=await fetch(`/api/experto/result/${s}`);if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const u=await h.json();console.log("Received data:",u),u.success?t(u.result):(d(u.error||"Die Ergebnisse konnten nicht geladen werden."),x({title:"Fehler",description:u.error||"Die Ergebnisse konnten nicht geladen werden.",variant:"destructive"}))}catch(h){console.error("Error fetching result:",h),d("Die Ergebnisse konnten nicht geladen werden. Bitte versuchen Sie es später erneut."),x({title:"Fehler",description:"Die Ergebnisse konnten nicht geladen werden. Bitte versuchen Sie es später erneut.",variant:"destructive"})}finally{l(!1)}})()},[s,x]),r?e.jsx("div",{className:"container py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx(p,{className:"h-8 w-3/4 mb-4"}),e.jsx(p,{className:"h-4 w-1/2 mb-8"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(p,{className:"h-40 w-full"}),e.jsx(p,{className:"h-64 w-full"}),e.jsx(p,{className:"h-32 w-full"})]})]})}):i||!a?e.jsx("div",{className:"container py-12",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(S,{variant:"destructive",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx(T,{children:"Fehler"}),e.jsx(A,{children:i||"Die Ergebnisse konnten nicht geladen werden. Bitte versuchen Sie es später erneut."})]})})}):e.jsxs("div",{className:"container max-w-5xl mx-auto px-4 sm:px-6 py-8 sm:py-12",children:[e.jsxs("div",{className:"mb-6 sm:mb-8 text-center",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold tracking-tight text-gray-900 mb-3",children:"Ihr Unternehmenswert-Bericht"}),e.jsx("p",{className:"text-base sm:text-lg text-gray-600 max-w-2xl mx-auto",children:"Detaillierte Marktanalyse und Bewertung Ihres Unternehmens nach der bewährten Multiplikator-Methode."})]}),e.jsx("div",{children:e.jsx(K,{result:a})})]})}export{_ as default};
